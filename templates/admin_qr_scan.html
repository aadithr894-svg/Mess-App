<!DOCTYPE html>
<html>
<head>
  <title>QR Scanner</title>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
</head>
<body>
  <h2>Scan User QR</h2>
  <div id="reader" style="width:500px;"></div>
  <select id="meal_type">
    <option value="breakfast">Breakfast</option>
    <option value="lunch">Lunch</option>
    <option value="dinner">Dinner</option>
  </select>
  <p id="status"></p>

  <script>
    function onScanSuccess(decodedText, decodedResult) {
        const meal_type = document.getElementById('meal_type').value;
        fetch("/admin/scan_qr", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ qr_data: decodedText, meal_type: meal_type })
        })
        .then(res => res.json())
        .then(data => {
            document.getElementById('status').innerText = data.message;
        });
    }

    let html5QrcodeScanner = new Html5QrcodeScanner(
        "reader", { fps: 10, qrbox: 250 }
    );
    html5QrcodeScanner.render(onScanSuccess);
  </script>
</body>
</html>
